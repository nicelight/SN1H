# BRIEF — Telegram Azan Bot

## Контекст
Нужен телеграм‑бот, который в группе получает расписание азанов от бота‑источника `@vaktiNamozBot`, парсит 5 времен и публикует их в MQTT для HomeAssistant.

## Цель
Ежедневно получать актуальные времена азана и надежно доставлять их в MQTT в формате, удобном для автоматизаций.

## Основной сценарий
Бот каждые 5 минут отправляет в группу сообщение "Имрӯз" до тех пор, пока не увидит сообщение от `@vaktiNamozBot` с датой, совпадающей с текущей (по TZ `+05:00`, новый день начинается в 02:00). Бот не ждет reply, а парсит все сообщения источника. Затем парсит 5 времен и публикует их в MQTT.

## Границы (Scope)
- Telegram‑бот в группе.
- Парсинг 5 времен: `Субҳ`, `Қиём`, `Аср`, `Шом`, `Хуфтан`.
- MQTT публикации в раздельные топики `azan/today/*`.
- Кеш последнего успешного результата в `today-azan-time.json`.

## Не входит в scope
- Расчет времен азана самостоятельно.
- Поддержка локаций/городов/пользовательских настроек.
- Интерактивный UX, меню, много команд.

## Ограничения и допущения
- Источник данных только `@vaktiNamozBot`.
- В группе нет других сообщений (кроме двух ботов).
- Таймзона фиксированная: `+05:00`, новый день начинается в 02:00.
- Переходов на летнее/зимнее время нет.
- Стек: `aiogram v3` + `aiomqtt`.
- Запуск как сервис на Debian.
- Креды/секреты храним в `.env`.
- Зависимости фиксируем в `requirements.txt`.

## Критерии успеха
- В нужный день публикуются 5 MQTT сообщений в корректном формате.
- Данные устойчиво обновляются каждый день.
- Логи позволяют быстро найти причину сбоя.
- При сбоях MQTT публикация после восстановления выполняется только при изменении данных.
